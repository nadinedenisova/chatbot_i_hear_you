-- database.sql
CREATE EXTENSION IF NOT EXISTS "pgcrypto";

-- Создать схему content
CREATE SCHEMA IF NOT EXISTS content;

-- Создать таблицы в схеме content
CREATE TABLE content."user" (
	"id" VARCHAR(255) PRIMARY KEY,
	"phone_number" VARCHAR(255) NOT NULL,
	"created_at" TIMESTAMP NOT NULL DEFAULT now(),
    "updated_at" TIMESTAMP NOT NULL DEFAULT now()
);

CREATE TABLE content.menu_node (
	"id" UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	"parent_id" UUID,
	"name" VARCHAR(255) NOT NULL,
	"text" TEXT,
	"subscription_type" VARCHAR(255)
);

CREATE TABLE content.content (
	"id" UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	"menu_id" UUID NOT NULL,
	"type" SMALLINT NOT NULL,
	"server_path" VARCHAR(500) NOT NULL,
	"created_at" TIMESTAMP NOT NULL DEFAULT now(),
    "updated_at" TIMESTAMP NOT NULL DEFAULT now()
);

CREATE TABLE content.question (
	"id" UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	"user_id" VARCHAR(255) NOT NULL,
	"text" TEXT NOT NULL,
	"admin_answer" TEXT,
	"created_at" TIMESTAMP NOT NULL DEFAULT now(),
    "updated_at" TIMESTAMP NOT NULL DEFAULT now()
);

CREATE TABLE content.history (
	"id" UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	"user_id" VARCHAR(255) NOT NULL,
	"action_date" TIMESTAMP NOT NULL,
	"menu_id" UUID,
	"created_at" TIMESTAMP NOT NULL DEFAULT now()
);

CREATE TABLE content.user_menu_node (
	"id" UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	"user_id" VARCHAR(255) NOT NULL,
	"menu_id" UUID NOT NULL,
	"post_rating" BOOLEAN,
	"created_at" TIMESTAMP NOT NULL DEFAULT now(),
    "updated_at" TIMESTAMP NOT NULL DEFAULT now(),
	UNIQUE ("user_id", "menu_id")
);


-- Добавление внешних ключей
ALTER TABLE content.menu_node ADD FOREIGN KEY ("parent_id") REFERENCES content.menu_node ("id");
ALTER TABLE content.content ADD FOREIGN KEY ("menu_id") REFERENCES content.menu_node ("id");
ALTER TABLE content.question ADD FOREIGN KEY ("user_id") REFERENCES content."user" ("id");
ALTER TABLE content.history ADD FOREIGN KEY ("user_id") REFERENCES content."user" ("id");
ALTER TABLE content.history ADD FOREIGN KEY ("menu_id") REFERENCES content.menu_node ("id");
ALTER TABLE content.user_menu_node ADD FOREIGN KEY ("menu_id") REFERENCES content.menu_node ("id");
ALTER TABLE content.user_menu_node ADD FOREIGN KEY ("user_id") REFERENCES content."user" ("id");


-- Вставка тестовых данных
INSERT INTO content."user" ("id", "phone_number") VALUES
('user_001', '+79161234567'),
('user_002', '+79169876543'),
('user_003', '+79155556677'),
('225894988', '+79648773155');

INSERT INTO content.menu_node ("id", "parent_id", "name", "text", "subscription_type") VALUES
-- Корень
('00000000-0000-0000-0000-000000000001', NULL, 'Главное меню', 'Здравствуйте! Я бот-помощник "ано я тебя слышу". Мы помогаем семьям с детьми с нарушением слуха. Здесь вы найдете проверенную информацию и поддержку на каждом этапе. Чтобы я мог показать вам самые нужные материалы, выберите, пожалуйста, ваш путь.', 'free'),

-- (уровень 0)
('00000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', 'Я волнуюсь о слухе ребенка', 'Вы выбрали раздел для родителей. Это большой путь, и вы не одни. Мы собрали информацию по самым важным темам — от первых шагов после диагноза до вопросов школы и социализации. Выберите, что вас беспокоит в первую очередь.', 'free'),
('00000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001', 'Я волнуюсь о своем слухе', 'Раздел для взрослых с нарушением слуха находится в разработке.', 'free'),

-- Добавляем узлы уровня "Я волнуюсь о слухе ребенка" (уровень 1)
('00000000-0000-0000-0000-000000000011', '00000000-0000-0000-0000-000000000002', 'Диагноз: что делать?', 'Получение диагноза — это время сильных эмоций: растерянность, страх, непонимание. Это абсолютно нормально. Давайте пройдем этот путь шаг за шагом. Что вас волнует прямо сейчас?', 'free'),
('00000000-0000-0000-0000-000000000012', '00000000-0000-0000-0000-000000000002', 'Слуховые аппараты и кохлеарные импланты', 'Компенсация слуха — важный шаг, который открывает ребенку мир звуков. Здесь мы поможем разобраться в видах аппаратов, процессе их выбора, получения и привыкания.', 'free'),
('00000000-0000-0000-0000-000000000013', '00000000-0000-0000-0000-000000000002', 'Обучение, развитие и социализация', 'Развитие ребенка с нарушением слуха имеет свои особенности. Важно правильно выстроить занятия по развитию слуха и речи, а также помочь ребенку общаться со сверстниками.', 'free'),
('00000000-0000-0000-0000-000000000014', '00000000-0000-0000-0000-000000000002', 'Инклюзия в детском саду и школе', 'Успешная инклюзия — это командная работа семьи, педагогов и ребенка. Здесь вы найдете практические руководства по правам, адаптации среды и выстраиванию отношений с образовательным учреждением, чтобы обучение было комфортным и эффективным.', 'free'),
('00000000-0000-0000-0000-000000000015', '00000000-0000-0000-0000-000000000002', 'Поддержка для родителей и полезные материалы', 'Забота о себе — это не эгоизм, а необходимость. Чтобы быть опорой для ребенка, важно восстанавливать силы. Здесь вы найдете психологическую помощь, общение с теми, кто понимает, и ответы на вопросы, которые не всегда удобно задать вслух.', 'free'),

-- Добавление дочерних узлов для "1.Диагноз: что делать?" (уровень 2)
('00000000-0000-0000-0000-000000000101', '00000000-0000-0000-0000-000000000011', 'Первые шаги: краткий план', '', 'free'),
('00000000-0000-0000-0000-000000000102', '00000000-0000-0000-0000-000000000011', 'Как справиться с шоком?', '', 'free'),
('00000000-0000-0000-0000-000000000103', '00000000-0000-0000-0000-000000000011', 'Понимание диагноза', '', 'free'),

-- Добавление дочерних узлов для "Первые шаги: краткий план" (уровень 3)
('00000000-0000-0000-0000-000000000201', '00000000-0000-0000-0000-000000000101', 'Дневник слухопротезирования ребенка раннего возраста', '', 'free'),
('00000000-0000-0000-0000-000000000202', '00000000-0000-0000-0000-000000000101', 'Влияние потери слуха на семью', 'https://www.ihearyou.ru/materials/articles/vliyanie-poteri-slukha-na-semyu', 'free'),
('00000000-0000-0000-0000-000000000203', '00000000-0000-0000-0000-000000000101', 'Что родителям надо знать о братьях и сёстрах', 'https://www.ihearyou.ru/materials/articles/chto-roditelyam-nado-znat-o-bratyakh-i-syestrakh', 'free'),
('00000000-0000-0000-0000-000000000204', '00000000-0000-0000-0000-000000000101', 'Что важно знать о слухе ребенка', 'https://www.ihearyou.ru/materials/skachat/chto-vazhno-znat-o-slukhe-rebenka', 'free'),
('00000000-0000-0000-0000-000000000205', '00000000-0000-0000-0000-000000000101', 'У моего ребенка нарушен слух', '', 'free'),

-- Добавление дочерних узлов для "Как справиться с шоком?" (уровень 3)
('00000000-0000-0000-0000-000000000206', '00000000-0000-0000-0000-000000000102', 'Как принять диагноз. История слонёнка Дамбо.', 'https://www.ihearyou.ru/materials/articles/kak-prinyat-diagnoz-istoriya-slonyenka-dambo', 'free'),
('00000000-0000-0000-0000-000000000207', '00000000-0000-0000-0000-000000000102', 'Как принять диагноз «Нарушение слуха». (видео формат)', '', 'free'),

-- Добавление дочерних узлов для "Понимание диагноза" (уровень 3)
('00000000-0000-0000-0000-000000000208', '00000000-0000-0000-0000-000000000103', 'Экссудативный отит', '', 'free'),
('00000000-0000-0000-0000-000000000209', '00000000-0000-0000-0000-000000000103', 'Менингит и детская глухота', '', 'free'),
('00000000-0000-0000-0000-000000000210', '00000000-0000-0000-0000-000000000103', 'Дети с микротией и атрезией', '', 'free'),
('00000000-0000-0000-0000-000000000211', '00000000-0000-0000-0000-000000000103', 'У моего ребенка нарушен слух', '', 'free'),

-- Добавление дочерних узлов для "Слуховые аппараты и кохлеарные импланты" (уровень 2)
('00000000-0000-0000-0000-000000000104', '00000000-0000-0000-0000-000000000012', 'Слуховые аппараты (СА)', '', 'free'),
('00000000-0000-0000-0000-000000000105', '00000000-0000-0000-0000-000000000012', 'Кохлеарные импланты (КИ)', '', 'free'),
('00000000-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000012', 'Как сделать выбор?', 'Сравнение', 'free'),
('00000000-0000-0000-0000-000000000107', '00000000-0000-0000-0000-000000000012', 'Права и компенсации', '', 'free'),

-- Добавление дочерних узлов для "Слуховые аппараты (СА)" (уровень 3)
('00000000-0000-0000-0000-000000000212', '00000000-0000-0000-0000-000000000104', 'Дневник слухопротезирования ребенка раннего возраста', '', 'free'),
('00000000-0000-0000-0000-000000000213', '00000000-0000-0000-0000-000000000104', 'Слухопротезирование', 'https://www.ihearyou.ru/materials/articles/slukhoprotezirovanie', 'free'),
('00000000-0000-0000-0000-000000000214', '00000000-0000-0000-0000-000000000104', 'Как правильно надеть слуховой аппарат', 'https://www.ihearyou.ru/materials/articles/kak-pravilno-nadet-slukhovoy-apparat', 'free'),
('00000000-0000-0000-0000-000000000215', '00000000-0000-0000-0000-000000000104', 'Как правильно снимать слуховой аппарат', 'https://www.ihearyou.ru/materials/articles/kak-pravilno-snimat-slukhovoy-apparat', 'free'),
('00000000-0000-0000-0000-000000000216', '00000000-0000-0000-0000-000000000104', 'Проверить работоспособность слухового аппарата', 'https://www.ihearyou.ru/materials/articles/kak-proverit-rabotaet-li-slukhovoy-apparat', 'free'),
('00000000-0000-0000-0000-000000000217', '00000000-0000-0000-0000-000000000104', 'Уход за слуховым аппаратом', 'https://www.ihearyou.ru/materials/articles/kak-ukhazhivat-za-slukhovym-apparatom', 'free'),
('00000000-0000-0000-0000-000000000218', '00000000-0000-0000-0000-000000000104', 'Батарейки для слухового аппарата', 'https://www.ihearyou.ru/materials/articles/elementy-pitaniya-batareyki-dlya-slukhovykh-apparatov', 'free'),
('00000000-0000-0000-0000-000000000219', '00000000-0000-0000-0000-000000000104', 'Почему свистит слуховой аппарат', 'https://www.ihearyou.ru/materials/articles/pochemu-slukhovoy-apparat-svistit', 'free'),
('00000000-0000-0000-0000-000000000220', '00000000-0000-0000-0000-000000000104', 'Уход за ушным вкладышем', 'https://www.ihearyou.ru/materials/articles/ukhod-za-ushnym-vkladyshem', 'free'),
('00000000-0000-0000-0000-000000000221', '00000000-0000-0000-0000-000000000104', 'Советы по адаптации ребенка к слуховому аппарату', 'https://www.ihearyou.ru/materials/articles/sovety-po-adaptatsii-rebenka-k-ispolzovaniyu-slukhovykh-apparatov', 'free'),
('00000000-0000-0000-0000-000000000222', '00000000-0000-0000-0000-000000000104', 'Изменения в поведении ребенка при использовании слухового аппарата', 'https://www.ihearyou.ru/materials/articles/kakie-izmeneniya-v-povedenii-rebenka-mozhno-zhdat-posle-togo-kak-on-nachal-nosit-slukhovoy-apparat', 'free'),
('00000000-0000-0000-0000-000000000223', '00000000-0000-0000-0000-000000000104', 'Почему ребенок не хочет носить слуховой аппарат', 'https://www.ihearyou.ru/materials/articles/esli-rebenok-snimaet-slukhovoy-apparat', 'free'),
('00000000-0000-0000-0000-000000000224', '00000000-0000-0000-0000-000000000104', 'Как развивать у ребёнка умение слышать в слуховых аппаратах', 'https://www.ihearyou.ru/materials/articles/kak-razvivat-u-rebyenka-umenie-slyshat-v-slukhovykh-apparatakh', 'free'),
('00000000-0000-0000-0000-000000000225', '00000000-0000-0000-0000-000000000104', 'Как развивать у ребёнка умение говорить в слуховых аппаратах', 'https://www.ihearyou.ru/materials/articles/kak-razvivat-u-rebyenka-umenie-govorit-v-slukhovykh-apparatakh', 'free'),

-- Добавление дочерних узлов для "Кохлеарные импланты (КИ)" (уровень 3)
('00000000-0000-0000-0000-000000000226', '00000000-0000-0000-0000-000000000105', 'Дневник слухопротезирования ребенка раннего возраста', '', 'free'),
('00000000-0000-0000-0000-000000000227', '00000000-0000-0000-0000-000000000105', 'Слухопротезирование', 'https://www.ihearyou.ru/materials/articles/slukhoprotezirovanie', 'free'),
('00000000-0000-0000-0000-000000000228', '00000000-0000-0000-0000-000000000105', 'Кохлеарная имплантация (видео формат)', '', 'free'),

-- Добавление дочерних узлов для "Права и компенсации" (уровень 3)
('00000000-0000-0000-0000-000000000229', '00000000-0000-0000-0000-000000000107', 'Классификации и критерии для МСЭ', '', 'free'),
('00000000-0000-0000-0000-000000000230', '00000000-0000-0000-0000-000000000107', 'Установление инвалидности до 18 лет', '', 'free'),
('00000000-0000-0000-0000-000000000231', '00000000-0000-0000-0000-000000000107', 'Правило обеспечения инвалидов ТСР', '', 'free'),
('00000000-0000-0000-0000-000000000232', '00000000-0000-0000-0000-000000000107', 'Порядок выплаты компенсации за самостоятельно приобретенное ТСР', '', 'free'),

-- Добавление дочерних узлов для "Обучение, развитие и социализация" (уровень 2)
('00000000-0000-0000-0000-000000000108', '00000000-0000-0000-0000-000000000013', 'Развитие слуха и речи', '', 'free'),
('00000000-0000-0000-0000-000000000109', '00000000-0000-0000-0000-000000000013', 'Познавательное развитие', '', 'free'),
('00000000-0000-0000-0000-000000000110', '00000000-0000-0000-0000-000000000013', 'Социализация и общение', '', 'free'),
('00000000-0000-0000-0000-000000000111', '00000000-0000-0000-0000-000000000013', 'Подготовка к детскому саду и школе', '', 'free'),

-- Добавление дочерних узлов для "Развитие слуха и речи" (уровень 3)
('00000000-0000-0000-0000-000000000233', '00000000-0000-0000-0000-000000000108', 'Практическое руководство по поддержке ребенка в освоении языка', '', 'free'),
('00000000-0000-0000-0000-000000000234', '00000000-0000-0000-0000-000000000108', 'Обучающий игровой онлайн-курс "Пусть каждый ребенок услышит"', 'https://www.ihearyou.ru/materials/obrazovanie/obuchayushchiy-igrovoy-onlayn-kurs-pust-kazhdyy-rebenok-uslyshit', 'free'),
('00000000-0000-0000-0000-000000000235', '00000000-0000-0000-0000-000000000108', 'Обучающие видео для учителей и всех, кому интересна тема инклюзии', 'https://www.ihearyou.ru/materials/video/rebyenok-s-narusheniem-slukha-v-massovoy-shkole-i-na-distantsionnom-obuchenii', 'free'),
('00000000-0000-0000-0000-000000000236', '00000000-0000-0000-0000-000000000108', 'Учим эмоции с малышом (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000237', '00000000-0000-0000-0000-000000000108', 'Настройка речевого процесса (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000238', '00000000-0000-0000-0000-000000000108', 'Базовый курс РЖЯ для детей', 'https://www.ihearyou.ru/materials/bazovyy-kurs-rzhya-dlya-detey/bazovyy-kurs-rzhya-dlya-detey', 'free'),

-- Добавление дочерних узлов для "Познавательное развитие" (уровень 3)
('00000000-0000-0000-0000-000000000239', '00000000-0000-0000-0000-000000000109', 'Книга "Ребенок с нарушенным слухом в массовой школе: самое важное, что должен знать учитель"', 'https://www.ihearyou.ru/materials/o-potrebnostyakh-i-osobennostyakh-detey-s-narushennym-slukhom/kniga-rebenok-s-narushennym-slukhom-v-massovoy-shkole-samoe-vazhnoe-chto-dolzhen-znat-uchitel', 'free'),
('00000000-0000-0000-0000-000000000240', '00000000-0000-0000-0000-000000000109', 'Базовый курс РЖЯ для детей', 'https://www.ihearyou.ru/materials/o-potrebnostyakh-i-osobennostyakh-detey-s-narushennym-slukhom/kniga-rebenok-s-narushennym-slukhom-v-massovoy-shkole-samoe-vazhnoe-chto-dolzhen-znat-uchitel', 'free'),
('00000000-0000-0000-0000-000000000241', '00000000-0000-0000-0000-000000000109', 'Учим гласные и согласные (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000242', '00000000-0000-0000-0000-000000000109', 'Учим эмоции с малышом (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000243', '00000000-0000-0000-0000-000000000109', 'Учим животных и все что с ними связано (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000244', '00000000-0000-0000-0000-000000000109', 'Учим цвета (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000245', '00000000-0000-0000-0000-000000000109', 'Различие односложных и двусложных слов (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000246', '00000000-0000-0000-0000-000000000109', 'Как нам помогают повторяющиеся действия (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000247', '00000000-0000-0000-0000-000000000109', 'Учим глаголы (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000248', '00000000-0000-0000-0000-000000000109', 'Учим противоположности (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000249', '00000000-0000-0000-0000-000000000109', 'Обобщающие слова (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000250', '00000000-0000-0000-0000-000000000109', 'Развитие ритмической структуры речи (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000251', '00000000-0000-0000-0000-000000000109', 'Учим грамматику (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000252', '00000000-0000-0000-0000-000000000109', 'Логическое мышление (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000253', '00000000-0000-0000-0000-000000000109', 'Артикуляционная гимнастика (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000254', '00000000-0000-0000-0000-000000000109', 'Пиктограммы (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000255', '00000000-0000-0000-0000-000000000109', 'Комикс «Команда С.Л.У.Х.»', 'https://www.ihearyou.ru/materials/o-potrebnostyakh-i-osobennostyakh-detey-s-narushennym-slukhom/komiks-komanda-s-l-u-h', 'free'),
('00000000-0000-0000-0000-000000000256', '00000000-0000-0000-0000-000000000109', 'Обучающий игровой онлайн-курс "Пусть каждый ребенок услышит"', 'https://www.ihearyou.ru/materials/obrazovanie/obuchayushchiy-igrovoy-onlayn-kurs-pust-kazhdyy-rebenok-uslyshit', 'free'),
('00000000-0000-0000-0000-000000000257', '00000000-0000-0000-0000-000000000109', 'Курс по обучению иллюстрации «Рисуй мечту!»', 'https://www.ihearyou.ru/materials/video/kurs-risuy-mechtu', 'free'),
('00000000-0000-0000-0000-000000000258', '00000000-0000-0000-0000-000000000109', 'Лекции «Анимация и Я»', 'https://www.ihearyou.ru/materials/video/animatsiya-i-ya-lektsii', 'free'),
('00000000-0000-0000-0000-000000000259', '00000000-0000-0000-0000-000000000109', 'Практические занятия «Анимация и Я»', 'https://www.ihearyou.ru/materials/video/animatsiya-i-ya-prakticheskie-zanyatiya', 'free'),
('00000000-0000-0000-0000-000000000260', '00000000-0000-0000-0000-000000000109', 'Мастер-класс: рисуем Остина, главного героя игры HomeScapes', 'https://www.ihearyou.ru/materials/video/master-klass-risuem-ostina-glavnogo-geroya-igry-homescapes', 'free'),

-- Добавление дочерних узлов для "Социализация и общение" (уровень 3)
('00000000-0000-0000-0000-000000000261', '00000000-0000-0000-0000-000000000110', 'Психологические последствия нарушения слуха у подростков', '', 'free'),
('00000000-0000-0000-0000-000000000262', '00000000-0000-0000-0000-000000000110', 'Роль отцов в воспитании детей с нарушенным слухом', '', 'free'),
('00000000-0000-0000-0000-000000000263', '00000000-0000-0000-0000-000000000110', 'Базовый курс РЖЯ для детей', 'https://www.ihearyou.ru/materials/bazovyy-kurs-rzhya-dlya-detey/bazovyy-kurs-rzhya-dlya-detey', 'free'),

-- Добавление дочерних узлов для "Подготовка к детскому саду и школе" (уровень 3)
('00000000-0000-0000-0000-000000000264', '00000000-0000-0000-0000-000000000111', 'Обучающие видео для учителей и всех, кому интересна тема инклюзии', 'https://www.ihearyou.ru/materials/video/rebyenok-s-narusheniem-slukha-v-massovoy-shkole-i-na-distantsionnom-obuchenii', 'free'),
('00000000-0000-0000-0000-000000000265', '00000000-0000-0000-0000-000000000111', 'Обучающий игровой онлайн-курс "Пусть каждый ребенок услышит"', 'https://www.ihearyou.ru/materials/obrazovanie/obuchayushchiy-igrovoy-onlayn-kurs-pust-kazhdyy-rebenok-uslyshit', 'free'),
('00000000-0000-0000-0000-000000000266', '00000000-0000-0000-0000-000000000111', 'Психологические последствия нарушения слуха у подростков', '', 'free'),

-- Добавление дочерних узлов для "Инклюзия в детском саду и школе" (уровень 2)
('00000000-0000-0000-0000-000000000112', '00000000-0000-0000-0000-000000000014', 'Права ребенка и ваши права', '', 'free'),
('00000000-0000-0000-0000-000000000113', '00000000-0000-0000-0000-000000000014', 'Выбор учреждения и подготовка', '', 'free'),
('00000000-0000-0000-0000-000000000114', '00000000-0000-0000-0000-000000000014', 'Взаимодействие с педагогами', '', 'free'),

-- Добавление дочерних узлов для "Взаимодействие с педагогами" (уровень 3)
('00000000-0000-0000-0000-000000000267', '00000000-0000-0000-0000-000000000114', 'Книга "Ребенок с нарушенным слухом в массовой школе: самое важное, что должен знать учитель"', 'https://www.ihearyou.ru/materials/o-potrebnostyakh-i-osobennostyakh-detey-s-narushennym-slukhom/kniga-rebenok-s-narushennym-slukhom-v-massovoy-shkole-samoe-vazhnoe-chto-dolzhen-znat-uchitel', 'free'),
('00000000-0000-0000-0000-000000000268', '00000000-0000-0000-0000-000000000114', 'Обучающий игровой онлайн-курс "Пусть каждый ребенок услышит"', 'https://www.ihearyou.ru/materials/obrazovanie/obuchayushchiy-igrovoy-onlayn-kurs-pust-kazhdyy-rebenok-uslyshit', 'free'),
('00000000-0000-0000-0000-000000000269', '00000000-0000-0000-0000-000000000114', 'Обучающие видео для учителей и всех, кому интересна тема инклюзии', 'https://www.ihearyou.ru/materials/video/rebyenok-s-narusheniem-slukha-v-massovoy-shkole-i-na-distantsionnom-obuchenii', 'free'),
('00000000-0000-0000-0000-000000000270', '00000000-0000-0000-0000-000000000114', 'Курс повышения квалификации «Обучение детей с ОВЗ: ребёнок с нарушением слуха в массовой школе»', 'https://www.ihearyou.ru/materials/obrazovanie/kurs-povysheniya-kvalifikatsii-obuchenie-detey-s-ovz-rebenok-s-narusheniem-slukha-v-massovoy-shkole', 'free'),

-- Добавление дочерних узлов для "Поддержка для родителей и полезные материалы" (уровень 2)
('00000000-0000-0000-0000-000000000115', '00000000-0000-0000-0000-000000000015', 'Психологическая помощь', '', 'free'),
('00000000-0000-0000-0000-000000000116', '00000000-0000-0000-0000-000000000015', 'Сообщество и обмен опытом', '', 'free'),
('00000000-0000-0000-0000-000000000117', '00000000-0000-0000-0000-000000000015', 'Полезные материалы для родителей', '', 'free'),
('00000000-0000-0000-0000-000000000118', '00000000-0000-0000-0000-000000000015', 'Материальная поддержка', '', 'free'),

-- Добавление дочерних узлов для "Психологическая помощь" (уровень 3)
('00000000-0000-0000-0000-000000000271', '00000000-0000-0000-0000-000000000115', 'Как общаться с малышом, пока он ещё не слышит?', '(до получения слухового аппарата или кохлеарного импланта)', 'free'),
('00000000-0000-0000-0000-000000000272', '00000000-0000-0000-0000-000000000115', '6 плюсов потери слуха, о которых вы, возможно, даже не задумывались', 'https://www.ihearyou.ru/materials/articles/plyusy-poteri-slukha-6-punktov-o-kotorykh-vy-vozmozhno-dazhe-ne-zadumyvalis', 'free'),

-- Добавление дочерних узлов для "Сообщество и обмен опытом" (уровень 3)
('00000000-0000-0000-0000-000000000273', '00000000-0000-0000-0000-000000000116', 'Скорая помощь от родителей родителям', 'https://www.ihearyou.ru/materials/skoraya-pomoshch-ot-roditeley-roditelyam/skoraya-pomoshch-ot-roditeley-roditelyam', 'free'),
('00000000-0000-0000-0000-000000000274', '00000000-0000-0000-0000-000000000116', 'Подкаст о слухе «Не понаслышке»', 'https://www.ihearyou.ru/materials/podkast/podkast-o-slukhe-ne-ponaslyshke', 'free'),

-- Добавление дочерних узлов для "Полезные материалы для родителей" (уровень 3)
('00000000-0000-0000-0000-000000000275', '00000000-0000-0000-0000-000000000117', 'Подкаст о слухе «Не понаслышке»', 'https://www.ihearyou.ru/materials/podkast/podkast-o-slukhe-ne-ponaslyshke', 'free'),
('00000000-0000-0000-0000-000000000276', '00000000-0000-0000-0000-000000000117', 'Роль отцов в воспитании детей с нарушенным слухом', '', 'free'),
('00000000-0000-0000-0000-000000000277', '00000000-0000-0000-0000-000000000117', 'Классификации и критерии для МСЭ', '', 'free'),
('00000000-0000-0000-0000-000000000278', '00000000-0000-0000-0000-000000000117', 'Установление инвалидности до 18 лет', '', 'free'),
('00000000-0000-0000-0000-000000000279', '00000000-0000-0000-0000-000000000117', 'Правило обеспечения инвалидов ТСР', '', 'free'),
('00000000-0000-0000-0000-000000000280', '00000000-0000-0000-0000-000000000117', 'Порядок выплаты компенсации за самостоятельно приобретенное ТСР', '', 'free'),
('00000000-0000-0000-0000-000000000281', '00000000-0000-0000-0000-000000000117', 'Книга Билингвинизм. Роль жестового языка в языковом и когнитивном развитии детей с нарушенным слухом', '', 'free'),
('00000000-0000-0000-0000-000000000282', '00000000-0000-0000-0000-000000000117', 'Учим малыша слышать и говорить', 'https://www.ihearyou.ru/materials/uchim-malysha-slyshat-i-govorit/uchim-malisha-slyshat-i-govorit', 'free'),
('00000000-0000-0000-0000-000000000283', '00000000-0000-0000-0000-000000000117', 'Аудиограмма. Зачем она и как в ней разобраться? (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000284', '00000000-0000-0000-0000-000000000117', 'Вопросы к аудиологу (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000285', '00000000-0000-0000-0000-000000000117', 'Ключевые этапы слухоречевой реабилитации (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000286', '00000000-0000-0000-0000-000000000117', 'Основные принципы взаимодействия с малышом (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000287', '00000000-0000-0000-0000-000000000117', 'Первые звуки после операции (видео формат)', '', 'free'),
('00000000-0000-0000-0000-000000000288', '00000000-0000-0000-0000-000000000117', 'Полезное развлечение для ребенка. Звуковой тест', '', 'free'),

-- Добавление дочерних узлов для "Материальная поддержка" (уровень 3)
('00000000-0000-0000-0000-000000000289', '00000000-0000-0000-0000-000000000118', 'Правило обеспечения инвалидов ТСР', '', 'free'),
('00000000-0000-0000-0000-000000000290', '00000000-0000-0000-0000-000000000118', 'Порядок выплаты компенсации за самостоятельно приобретенное ТСР', '', 'free');


INSERT INTO content.content ("menu_id", "type", "server_path") VALUES
('00000000-0000-0000-0000-000000000201', 3, 'uploaded_content/Diary_hearing_prosthetics.pdf'),
('00000000-0000-0000-0000-000000000205', 3, 'uploaded_content/Child_hearing_impaired.pdf'),
('00000000-0000-0000-0000-000000000207', 2, 'uploaded_content/Accept_hearing_loss.mp4'),
('00000000-0000-0000-0000-000000000208', 3, 'uploaded_content/Exudative_otitis.pdf'),
('00000000-0000-0000-0000-000000000209', 3, 'uploaded_content/Child_hearing_impaired.pdf'),
('00000000-0000-0000-0000-000000000210', 3, 'uploaded_content/Children_microtia_atresia.pdf'),
('00000000-0000-0000-0000-000000000211', 3, 'uploaded_content/Child_hearing_impaired.pdf'),
('00000000-0000-0000-0000-000000000212', 3, 'uploaded_content/Diary_hearing_prosthetics.pdf'),
('00000000-0000-0000-0000-000000000226', 3, 'uploaded_content/Diary_hearing_prosthetics.pdf'),
('00000000-0000-0000-0000-000000000228', 2, 'uploaded_content/Cochlear_implantation.mp4'),
('00000000-0000-0000-0000-000000000229', 3, 'uploaded_content/Classification_criteria_MSE.pdf'),
('00000000-0000-0000-0000-000000000230', 3, 'uploaded_content/Disability_establishment_minors.pdf'),
('00000000-0000-0000-0000-000000000231', 3, 'uploaded_content/Rules_providing_TSR.pdf'),
('00000000-0000-0000-0000-000000000232', 3, 'uploaded_content/Compensation_procedure_TSR.pdf'),
('00000000-0000-0000-0000-000000000233', 3, 'uploaded_content/Practical_guide_language.pdf'),
('00000000-0000-0000-0000-000000000236', 2, 'uploaded_content/Learning_emotions_baby.mp4'),
('00000000-0000-0000-0000-000000000237', 2, 'uploaded_content/Speech_processor_setting.mp4'),
('00000000-0000-0000-0000-000000000241', 2, 'uploaded_content/Learning_vowels_consonants.mp4'),
('00000000-0000-0000-0000-000000000242', 2, 'uploaded_content/Learning_emotions_toddler.mp4'),
('00000000-0000-0000-0000-000000000243', 2, 'uploaded_content/Learning_animals_related.mp4'),
('00000000-0000-0000-0000-000000000244', 2, 'uploaded_content/Learning_colors.mp4'),
('00000000-0000-0000-0000-000000000245', 2, 'uploaded_content/Distinguishing_monosyllabic_disyllabic.mp4'),
('00000000-0000-0000-0000-000000000246', 2, 'uploaded_content/Helping_repetitive_actions.mp4'),
('00000000-0000-0000-0000-000000000247', 2, 'uploaded_content/Learning_verbs.mp4'),
('00000000-0000-0000-0000-000000000248', 2, 'uploaded_content/Learning_opposites.mp4'),
('00000000-0000-0000-0000-000000000249', 2, 'uploaded_content/Generalizing_words.mp4'),
('00000000-0000-0000-0000-000000000250', 2, 'uploaded_content/Development_rhythmic_speech.mp4'),
('00000000-0000-0000-0000-000000000251', 2, 'uploaded_content/Learning_grammar.mp4'),
('00000000-0000-0000-0000-000000000252', 2, 'uploaded_content/Logical_thinking.mp4'),
('00000000-0000-0000-0000-000000000253', 2, 'uploaded_content/Articulation_gymnastics.mp4'),
('00000000-0000-0000-0000-000000000254', 2, 'uploaded_content/Pictograms_video.mp4'),
('00000000-0000-0000-0000-000000000261', 3, 'uploaded_content/Psychological_hearing_loss.pdf'),
('00000000-0000-0000-0000-000000000262', 3, 'uploaded_content/Role_fathers_parenting.pdf'),
('00000000-0000-0000-0000-000000000266', 3, 'uploaded_content/Psychological_hearing_loss.pdf'),
('00000000-0000-0000-0000-000000000271', 2, 'uploaded_content/Communicate_baby_prehearing.mp4'),
('00000000-0000-0000-0000-000000000276', 3, 'uploaded_content/Role_fathers_parenting.pdf'),
('00000000-0000-0000-0000-000000000277', 3, 'uploaded_content/Classification_criteria_MSE.pdf'),
('00000000-0000-0000-0000-000000000278', 3, 'uploaded_content/Disability_establishment_minors.pdf'),
('00000000-0000-0000-0000-000000000279', 3, 'uploaded_content/Rules_providing_TSR.pdf'),
('00000000-0000-0000-0000-000000000280', 3, 'uploaded_content/Compensation_procedure_TSR.pdf'),
('00000000-0000-0000-0000-000000000281', 3, 'uploaded_content/Book_bilingualism_sign.pdf'),
('00000000-0000-0000-0000-000000000283', 2, 'uploaded_content/Audiogram_purpose_understanding.mp4'),
('00000000-0000-0000-0000-000000000284', 2, 'uploaded_content/Questions_audiologist_answers.mp4'),
('00000000-0000-0000-0000-000000000285', 2, 'uploaded_content/Key_stages_rehabilitation.mp4'),
('00000000-0000-0000-0000-000000000286', 2, 'uploaded_content/Basic_principles_interaction.mp4'),
('00000000-0000-0000-0000-000000000287', 2, 'uploaded_content/First_sounds_postoperation.mp4'),
('00000000-0000-0000-0000-000000000288', 2, 'uploaded_content/Useful_entertainment_sound.mp4'),
('00000000-0000-0000-0000-000000000289', 3, 'uploaded_content/Rules_providing_TSR.pdf'),
('00000000-0000-0000-0000-000000000290', 3, 'uploaded_content/Compensation_procedure_TSR.pdf');


INSERT INTO content.question ("user_id", "text", "admin_answer") VALUES 
('user_001', 'Какой график работы вашей службы поддержки?', 'Наша служба поддержки работает с 9:00 до 18:00 по московскому времени в рабочие дни.'),
('user_002', 'Можно ли получить консультацию сурдолога онлайн?', 'Да, мы организуем онлайн-консультации со специалистами. Заполните форму на нашем сайте.'),
('user_003', 'Какие документы нужны для получения слухового аппарата?', NULL);

INSERT INTO content.history ("user_id", "menu_id", "action_date") VALUES 
('user_001', '00000000-0000-0000-0000-000000000001', '2024-01-15 10:00:00'),
('user_001', '00000000-0000-0000-0000-000000000002', '2024-01-15 10:05:00'),
('user_001', '00000000-0000-0000-0000-000000000011', '2024-01-15 10:10:00'),
('user_002', '00000000-0000-0000-0000-000000000001', '2024-01-16 11:00:00'),
('user_002', '00000000-0000-0000-0000-000000000012', '2024-01-16 11:15:00'),
('225894988', '00000000-0000-0000-0000-000000000001', '2024-01-16 11:15:00');

INSERT INTO content.user_menu_node ("user_id", "menu_id", "post_rating") VALUES 
('user_001', '00000000-0000-0000-0000-000000000001', TRUE),
('user_001', '00000000-0000-0000-0000-000000000011', TRUE),
('user_001', '00000000-0000-0000-0000-000000000012', TRUE),
('user_002', '00000000-0000-0000-0000-000000000001', TRUE),
('user_002', '00000000-0000-0000-0000-000000000011', FALSE),
('user_002', '00000000-0000-0000-0000-000000000012', FALSE),
('user_002', '00000000-0000-0000-0000-000000000013', FALSE),
('user_003', '00000000-0000-0000-0000-000000000001', FALSE),
('user_003', '00000000-0000-0000-0000-000000000011', TRUE),
('user_003', '00000000-0000-0000-0000-000000000013', FALSE);


-- Создание индексов
CREATE INDEX CONCURRENTLY idx_menu_node_parent_id ON content.menu_node(parent_id) WHERE parent_id IS NOT NULL;
CREATE INDEX CONCURRENTLY idx_content_menu_id ON content.content(menu_id);
CREATE INDEX CONCURRENTLY idx_history_user_id ON content.history(user_id);
CREATE INDEX CONCURRENTLY idx_history_menu_id ON content.history(menu_id) WHERE menu_id IS NOT NULL;
CREATE INDEX CONCURRENTLY idx_question_user_id ON content.question(user_id);
CREATE INDEX CONCURRENTLY idx_history_user_action_date ON content.history(user_id, action_date);
CREATE INDEX CONCURRENTLY idx_user_menu_node_menu_id_rating ON content.user_menu_node (menu_id, post_rating);
CREATE INDEX CONCURRENTLY idx_user_menu_node_menu_id ON content.user_menu_node(menu_id);